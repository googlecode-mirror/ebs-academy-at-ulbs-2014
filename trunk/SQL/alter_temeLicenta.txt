drop TABLE  IF EXISTS `ULBSPlatform`.`User_TemeLicenta`;
drop TABLE  IF EXISTS `Teme_Licenta`;

CREATE TABLE `Teme_Licenta` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `ID_USER` int(11) NOT NULL,
  `ID_GRUPA` int(11) NOT NULL,
  `ID_MATERIE` int(11) NOT NULL,
  `DENUMIRE_TEMA` varchar(150) NOT NULL,
  `DESCRIERE_TEMA` text NOT NULL,
  `STATUS` enum('AVAILABLE','PENDING','ASSIGNED') NOT NULL,
  `ANEXA` mediumblob,
  PRIMARY KEY (`ID`),
  KEY `GRUPA_idx` (`ID_GRUPA`),
  KEY `LICENTA_USER_idx` (`ID_USER`),
  KEY `LICENTA_MATERIE_idx` (`ID_MATERIE`),
  CONSTRAINT `LICENTA_GRUPA` FOREIGN KEY (`ID_GRUPA`) REFERENCES `Grupa` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `LICENTA_MATERIE` FOREIGN KEY (`ID_MATERIE`) REFERENCES `Materii` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `LICENTA_USER` FOREIGN KEY (`ID_USER`) REFERENCES `User` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;


CREATE TABLE `ULBSPlatform`.`User_TemeLicenta` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `ID_USER` INT NOT NULL,
  `ID_TEMA_LICENTA` INT NOT NULL,
  PRIMARY KEY (`ID`),
  INDEX `user_teme_idx` (`ID_USER` ASC),
  INDEX `ID_Licenta_idx` (`ID_TEMA_LICENTA` ASC),
  CONSTRAINT `Licenta_pt_User`
    FOREIGN KEY (`ID_USER`)
    REFERENCES `ULBSPlatform`.`User` (`ID`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `ID_Licenta`
    FOREIGN KEY (`ID_TEMA_LICENTA`)
    REFERENCES `ULBSPlatform`.`Teme_Licenta` (`ID`)
    ON DELETE CASCADE
    ON UPDATE CASCADE);